import{a as te}from"./chunk-2U2SCXIB.js";import{a as Ce,b as be}from"./chunk-S73STG6Q.js";import{a as ie,b as ne,c as re,d as oe,e as le,f as ae,g as me,h as se,i as pe,j as de,k as ce,l as ue,m as ge,n as fe,o as _e,p as he,q as xe,r as ye}from"./chunk-GIECZPGO.js";import{e as $,f as ee}from"./chunk-BVJELWYP.js";import{h as T}from"./chunk-ZMC5WGNU.js";import{c as R,f as X,j,p as O,r as Q}from"./chunk-74C73OEU.js";import{e as Y,f as Z}from"./chunk-65TSPMQQ.js";import{g as U,h as z,i as J}from"./chunk-SASYOJ3X.js";import{T as M,X as I,aa as K,m as q,n as N,q as P}from"./chunk-W4VWF4WH.js";import{Ab as y,Bb as _,Cb as d,Jb as A,Kb as m,Lb as v,Ob as C,Pb as b,Qa as k,Qb as E,R as S,Rb as H,Sb as L,Tb as h,Ua as a,Va as G,a as V,cc as W,ga as D,j as F,jb as f,lb as s,ob as w,pa as B,qa as c,ra as u,ub as n,vb as t,wb as p}from"./chunk-5ETVNT53.js";var we=()=>({"min-width":"55rem"}),ve=()=>["name","point","start_date","end_date"],Ee=()=>({width:"450px"}),Te=()=>({"margin-right":"20px"}),Ge=()=>({"margin-right":"10px","border-radius":"50%"}),Me=()=>({"border-radius":"50%"});function Ie(r,g){r&1&&p(0,"i",13)}function ke(r,g){if(r&1){let e=y();n(0,"p-button",14),_("click",function(){c(e);let i=d();return u(i.openNew())}),t(),n(1,"p-button",15),_("click",function(){c(e);let i=d();return u(i.deleteSelectedGifts())}),t()}if(r&2){let e=d();s("ngStyle",h(2,Te)),a(),s("disabled",!e.selectedGifts||!e.selectedGifts.length)}}function Ae(r,g){if(r&1){let e=y();n(0,"div",16)(1,"h5",17),m(2,"Qu\u1EA3n L\xFD Th\xF4ng Tin Qu\xE0 T\u1EB7ng"),t(),n(3,"span",18)(4,"p-iconField")(5,"p-inputIcon"),p(6,"i",19),t(),n(7,"input",20),_("input",function(i){c(e),d();let l=A(7);return u(l.filterGlobal(i.target==null?null:i.target.value,"contains"))}),t()()()()}}function Ve(r,g){r&1&&(n(0,"tr",21)(1,"th",22),p(2,"p-tableHeaderCheckbox"),t(),n(3,"th",23),m(4," T\xEAn qu\xE0 "),p(5,"p-sortIcon",24),t(),n(6,"th"),m(7,"\u1EA2nh"),t(),n(8,"th",25),m(9," \u0110i\u1EC3m "),p(10,"p-sortIcon",26),t(),n(11,"th",27),m(12," Ng\xE0y b\u1EAFt \u0111\u1EA7u "),p(13,"p-sortIcon",28),t(),n(14,"th",29),m(15," Ng\xE0y h\u1EBFt h\u1EA1n "),p(16,"p-sortIcon",30),t(),n(17,"th",31),m(18," Qu\xE0 Hot "),p(19,"p-sortIcon",32),t(),p(20,"th",33),t())}function Fe(r,g){r&1&&p(0,"i",42)}function De(r,g){if(r&1){let e=y();n(0,"tr",34)(1,"td",35),p(2,"p-tableCheckbox",36),t(),n(3,"td",37),m(4),t(),n(5,"td"),p(6,"img",38),t(),n(7,"td"),m(8),t(),n(9,"td"),m(10),t(),n(11,"td"),m(12),t(),n(13,"td"),f(14,Fe,1,0,"i",39),t(),n(15,"td")(16,"p-button",40),_("click",function(){let i=c(e).$implicit,l=d();return u(l.editGift(i))}),t(),n(17,"p-button",41),_("click",function(){let i=c(e).$implicit,l=d();return u(l.deleteGift(i))}),t()()()}if(r&2){let e=g.$implicit;d();let o=A(1);a(2),s("value",e),a(2),v(e.name),a(2),s("src",e.img,k)("alt",e.name),a(2),v(e.point),a(2),v(e.start_date),a(2),v(e.end_date),a(2),s("ngIf",e.isHot)("ngIfElse",o),a(2),w(h(15,Ge)),s("outlined",!0),a(),w(h(16,Me)),s("outlined",!0)}}function Be(r,g){r&1&&(n(0,"tr")(1,"td",43),m(2,"Kh\xF4ng c\xF3 qu\xE0 n\xE0o theo m\u1EE5c t\xECm ki\u1EBFm."),t()())}function He(r,g){if(r&1&&p(0,"img",58),r&2){let e=d(2);s("src",e.gift.img,k)("alt",e.gift.name)}}function Le(r,g){r&1&&(n(0,"small",59),m(1," T\xEAn qu\xE0 kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),t())}function We(r,g){if(r&1){let e=y();f(0,He,1,2,"img",44),n(1,"div",45)(2,"label",46),m(3,"T\xEAn qu\xE0"),t(),n(4,"input",47),E("ngModelChange",function(i){c(e);let l=d();return b(l.gift.name,i)||(l.gift.name=i),u(i)}),t(),f(5,Le,2,0,"small",48),t(),n(6,"div",45)(7,"label",49),m(8,"\u0110i\u1EC3m"),t(),n(9,"p-inputNumber",50),E("ngModelChange",function(i){c(e);let l=d();return b(l.gift.point,i)||(l.gift.point=i),u(i)}),t()(),n(10,"div",51)(11,"label",49),m(12,"Qu\xE0 hot"),t(),n(13,"div",52)(14,"div",53)(15,"p-radioButton",54),E("ngModelChange",function(i){c(e);let l=d();return b(l.gift.isHot,i)||(l.gift.isHot=i),u(i)}),t(),n(16,"label",55),m(17," C\xF3 "),t()(),n(18,"div",53)(19,"p-radioButton",56),E("ngModelChange",function(i){c(e);let l=d();return b(l.gift.isHot,i)||(l.gift.isHot=i),u(i)}),t(),n(20,"label",57),m(21," Kh\xF4ng "),t()()()()}if(r&2){let e=d();s("ngIf",e.gift.img),a(4),C("ngModel",e.gift.name),a(),s("ngIf",e.submitted&&!e.gift.name),a(4),C("ngModel",e.gift.point),a(6),s("value",!0),C("ngModel",e.gift.isHot),a(4),s("value",!1),C("ngModel",e.gift.isHot)}}function qe(r,g){if(r&1){let e=y();n(0,"p-button",60),_("click",function(){c(e);let i=d();return u(i.hideDialog())}),t(),n(1,"p-button",61),_("click",function(){c(e);let i=d();return u(i.saveGift())}),t()}r&2&&(s("text",!0),a(),s("text",!0))}var yt=(()=>{class r{constructor(e,o,i){this.giftService=e,this.confirmationService=o,this.messageService=i,this.giftDialog=!1,this.submitted=!1,this.destroyed$=new F,this.imgArray=["../../../../assets/img/gift-img/klever.png","../../../../assets/img/gift-img/nature.png","../../../../assets/img/gift-img/pibook.png","../../../../assets/img/gift-img/rose.png","../../../../assets/img/gift-img/Smoothie.png","../../../../assets/img/gift-img/viettel.png","../../../../assets/img/gift-img/vnmobile.png"]}ngOnInit(){this.fetchGiftList()}ngOnChanges(e){this.fetchGiftList()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}fetchGiftList(){this.giftService.getAllGift().pipe(S(this.destroyed$)).subscribe({next:e=>{this.giftList=e.data.result},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}})}openNew(){this.gift=new T,this.submitted=!1,this.giftDialog=!0}deleteSelectedGifts(){this.confirmationService.confirm({message:"X\xE1c nh\u1EADn xo\xE1 qu\xE0 t\u1EB7ng \u0111\xE3 ch\u1ECDn?",header:"X\xE1c nh\u1EADn",icon:"pi pi-exclamation-triangle",accept:()=>{this.giftService.deleteMultipleGift(this.selectedGifts).pipe(S(this.destroyed$)).subscribe({next:()=>{this.selectedGifts=null,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"Xo\xE1 qu\xE0 t\u1EB7ng th\xE0nh c\xF4ng",life:3e3}),setTimeout(()=>{this.fetchGiftList()},1500)},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}})}})}editGift(e){this.gift=V({},e),this.giftDialog=!0}deleteGift(e){this.confirmationService.confirm({message:"X\xE1c nh\u1EADn xo\xE1 "+e.name+"?",header:"X\xE1c nh\u1EADn",icon:"pi pi-exclamation-triangle",accept:()=>{this.giftService.deleteSelectedGifts(e._id).pipe(S(this.destroyed$)).subscribe({next:()=>{this.gift=new T,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"Xo\xE1 qu\xE0 t\u1EB7ng th\xE0nh c\xF4ng",life:3e3}),setTimeout(()=>{this.fetchGiftList()},1500)},error:o=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:o.error.errMessage,life:3e3})}})}})}hideDialog(){this.giftDialog=!1,this.submitted=!1}saveGift(){if(this.submitted=!0,this.gift.name==""){this.messageService.add({severity:"error",summary:"Th\u1EA5t b\u1EA1i",detail:"Vui l\xF2ng \u0111i\u1EC1n \u0111\u1EE7 th\xF4ng tin",life:1500});return}this.gift._id?this.giftService.updateGiftInfo(this.gift._id,this.gift).pipe(S(this.destroyed$)).subscribe({next:()=>{this.hideDialog(),this.gift=new T,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"C\u1EADp nh\u1EADt qu\xE0 t\u1EB7ng th\xE0nh c\xF4ng",life:1500}),setTimeout(()=>{this.fetchGiftList()},1500)},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}}):this.giftService.createNewGift(this.getRandomGiftImg(),this.gift.name,"14.01.2023","13.02.2023",this.gift.point,this.gift.isHot).pipe(S(this.destroyed$)).subscribe({next:()=>{this.hideDialog(),this.gift=new T,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"T\u1EA1o qu\xE0 t\u1EB7ng th\xE0nh c\xF4ng",life:3e3}),setTimeout(()=>{this.fetchGiftList()},1500)},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}})}getRandomGiftImg(){let e=Math.floor(Math.random()*this.imgArray.length);return this.imgArray[e]}static{this.\u0275fac=function(o){return new(o||r)(G(te),G(M),G(I))}}static{this.\u0275cmp=D({type:r,selectors:[["app-admin-gift"]],standalone:!0,features:[H([I,M]),B,L],decls:16,vars:19,consts:[["notIsHot",""],["dt",""],[1,"card"],["styleClass","mb-4 gap-2"],["pTemplate","left"],["dataKey","_id","currentPageReportTemplate","\u0110ang hi\u1EC7n t\u1EEB {first} t\u1EDBi {last} trong t\u1ED5ng s\u1ED1 {totalRecords} m\u1EE5c",3,"selectionChange","value","rows","paginator","tableStyle","selection","rowHover","showCurrentPageReport","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Th\xF4ng tin qu\xE0 t\u1EB7ng","styleClass","p-fluid quicksand-bold",3,"visibleChange","visible","modal","dismissableMask"],["pTemplate","content"],["pTemplate","footer"],[1,"mdi","mdi-window-close"],["label","T\u1EA1o m\u1EDBi","icon","pi pi-plus",3,"click","ngStyle"],["severity","danger","label","Xo\xE1","icon","pi pi-trash","outlined","",3,"click","disabled"],[1,"d-flex","flex-column","flex-md-row","align-items-center","justify-content-between","gap-3",2,"display","flex","align-items","center"],[1,"m-0","quicksand-bold"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","T\xECm ki\u1EBFm...","aria-label","Global Search",3,"input"],[1,"quicksand-bold"],[2,"width","5rem"],["pSortableColumn","name",2,"min-width","9rem"],["field","name"],["pSortableColumn","point",2,"min-width","10rem"],["field","point"],["pSortableColumn","start_date",2,"min-width","10rem"],["field","start_date"],["pSortableColumn","end_date",2,"min-width","10rem"],["field","end_date"],["pSortableColumn","isHot",2,"min-width","7rem"],["field","isHot"],[2,"min-width","12rem"],[1,"quicksand-normal"],[2,"width","3rem"],[3,"value"],[2,"min-width","10rem"],[2,"width","64px",3,"src","alt"],["class","mdi mdi-check",4,"ngIf","ngIfElse"],["icon","pi pi-pencil","severity","success",1,"mr-2",3,"click","outlined"],["icon","pi pi-trash","severity","danger",3,"click","outlined"],[1,"mdi","mdi-check"],["colspan","8"],["class","block m-auto pb-3",3,"src","alt",4,"ngIf"],[1,"field"],["for","name",1,"my-2"],["type","text","pInputText","","id","name","required","","autofocus","",3,"ngModelChange","ngModel"],["class","p-error",4,"ngIf"],["for","point",1,"my-2"],["id","point","required","",3,"ngModelChange","ngModel"],[1,"field","col"],[1,"flex","gap-3",2,"flex-wrap","nowrap","display","flex"],[1,"flex","align-items-center",2,"flex-shrink","0"],["name","isHot","inputId","isHotTrue",3,"ngModelChange","value","ngModel"],["for","isHotTrue",1,"ml-2",2,"margin-left","5px"],["name","isHot","inputId","isHotFalse",3,"ngModelChange","value","ngModel"],["for","isHotFalse",1,"ml-2",2,"margin-left","5px"],[1,"block","m-auto","pb-3",3,"src","alt"],[1,"p-error"],["label","H\u1EE7y","icon","pi pi-times",3,"click","text"],["label","L\u01B0u","icon","pi pi-check",3,"click","text"]],template:function(o,i){if(o&1){let l=y();f(0,Ie,1,0,"ng-template",null,0,W),n(2,"div",2),p(3,"p-toast"),n(4,"p-toolbar",3),f(5,ke,2,3,"ng-template",4),t(),n(6,"p-table",5,1),E("selectionChange",function(x){return c(l),b(i.selectedGifts,x)||(i.selectedGifts=x),u(x)}),f(8,Ae,8,0,"ng-template",6)(9,Ve,21,0,"ng-template",7)(10,De,18,17,"ng-template",8)(11,Be,3,0,"ng-template",9),t(),n(12,"p-dialog",10),E("visibleChange",function(x){return c(l),b(i.giftDialog,x)||(i.giftDialog=x),u(x)}),f(13,We,22,8,"ng-template",11)(14,qe,2,2,"ng-template",12),t(),p(15,"p-confirmDialog"),t()}o&2&&(a(6),s("value",i.giftList)("rows",10)("paginator",!0)("tableStyle",h(15,we)),C("selection",i.selectedGifts),s("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",h(16,ve)),a(6),w(h(17,Ee)),C("visible",i.giftDialog),s("modal",!0)("dismissableMask",!0),a(3),w(h(18,Ee)))},dependencies:[P,q,N,de,le,K,ae,me,se,pe,ue,ce,U,Z,Y,J,z,fe,ge,ee,$,ye,xe,he,_e,Q,R,X,O,j,oe,re,be,Ce,ne,ie]})}}return r})();export{yt as AdminGiftComponent};
