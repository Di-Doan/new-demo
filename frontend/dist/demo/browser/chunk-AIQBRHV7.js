import{a as z,b as J,e as Q,f as Y,g as Z,h as ee,i as te,j as ie,l as ne,m as re,n as oe,o as se,p as le,q as ae,r as ce}from"./chunk-GIECZPGO.js";import{e as G,f as N}from"./chunk-BVJELWYP.js";import{f as U}from"./chunk-ZMC5WGNU.js";import"./chunk-74C73OEU.js";import{e as K,f as W}from"./chunk-65TSPMQQ.js";import{g as R,h as O,i as q}from"./chunk-SASYOJ3X.js";import{T as v,X as C,aa as H,q as B,w as X,z as P}from"./chunk-W4VWF4WH.js";import{Ab as d,Bb as _,Cb as h,Jb as I,Kb as b,Lb as A,Ob as D,Pb as V,Qb as L,R as g,Rb as $,Sb as j,Tb as f,Ua as l,Va as S,X as E,aa as F,ga as M,j as T,jb as x,lb as a,ob as w,pa as k,qa as m,ra as u,ub as r,vb as n,wb as s}from"./chunk-5ETVNT53.js";var pe=(()=>{class t{constructor(e){this.http=e,this.apiUrl=`${P.apiUrl}/subscription`}getAllSubscription(){let e=`${this.apiUrl}/get-all-subscription`;return this.http.get(e,{withCredentials:!0})}deleteSelectedSubscriptions(e){let i=`${this.apiUrl}/delete-subscription-by-id/${e}`;return this.http.delete(i,{withCredentials:!0})}deleteMultipleSubscription(e){let i=`${this.apiUrl}/delete-multiple-subscription`;return this.http.post(i,e,{withCredentials:!0})}static{this.\u0275fac=function(i){return new(i||t)(F(X))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var de=()=>({"min-width":"55rem"}),he=()=>["email"],be=()=>({width:"450px"}),fe=()=>({"border-radius":"50%"});function ge(t,c){if(t&1){let e=d();r(0,"p-button",9),_("click",function(){m(e);let o=h();return u(o.deleteSelectedSubscriptions())}),n()}if(t&2){let e=h();a("disabled",!e.selectedSubscriptions||!e.selectedSubscriptions.length)}}function Se(t,c){if(t&1){let e=d();r(0,"div",10)(1,"h5",11),b(2,"Tra So\xE1t Th\xF4ng Tin \u0110\u0103ng K\xFD"),n(),r(3,"span",12)(4,"p-iconField")(5,"p-inputIcon"),s(6,"i",13),n(),r(7,"input",14),_("input",function(o){m(e),h();let p=I(5);return u(p.filterGlobal(o.target==null?null:o.target.value,"contains"))}),n()()()()}}function _e(t,c){t&1&&(r(0,"tr",15)(1,"th",16),s(2,"p-tableHeaderCheckbox"),n(),r(3,"th",17),b(4," Email "),s(5,"p-sortIcon",18),n(),s(6,"th",19),n())}function ve(t,c){if(t&1){let e=d();r(0,"tr",20)(1,"td",21),s(2,"p-tableCheckbox",22),n(),r(3,"td"),b(4),n(),r(5,"td")(6,"p-button",23),_("click",function(){let o=m(e).$implicit,p=h();return u(p.deleteSubscription(o))}),n()()()}if(t&2){let e=c.$implicit;l(2),a("value",e),l(2),A(e.userEmail),l(2),w(f(5,fe)),a("outlined",!0)}}function Ce(t,c){t&1&&(r(0,"tr")(1,"td",24),b(2,"Kh\xF4ng c\xF3 \u0111\u0103ng k\xFD n\xE0o theo m\u1EE5c t\xECm ki\u1EBFm."),n()())}var Ne=(()=>{class t{constructor(e,i,o){this.confirmationService=e,this.messageService=i,this.subscriptionService=o,this.submitted=!1,this.destroyed$=new T}ngOnInit(){this.fetchSubscriptionList()}ngOnChanges(){this.fetchSubscriptionList()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}fetchSubscriptionList(){this.subscriptionService.getAllSubscription().pipe(g(this.destroyed$)).subscribe({next:e=>{this.subscriptionList=e.data.result},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}})}deleteSelectedSubscriptions(){this.confirmationService.confirm({message:"X\xE1c nh\u1EADn xo\xE1 \u0111\u0103ng k\xFD \u0111\xE3 ch\u1ECDn?",header:"X\xE1c nh\u1EADn",icon:"pi pi-exclamation-triangle",accept:()=>{this.subscriptionService.deleteMultipleSubscription(this.selectedSubscriptions).pipe(g(this.destroyed$)).subscribe({next:()=>{this.selectedSubscriptions=null,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"Xo\xE1 \u0111\u0103ng k\xFD th\xE0nh c\xF4ng",life:3e3}),setTimeout(()=>{this.fetchSubscriptionList()},1500)},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}})}})}deleteSubscription(e){this.confirmationService.confirm({message:"X\xE1c nh\u1EADn xo\xE1 "+e.userEmail+"?",header:"X\xE1c nh\u1EADn",icon:"pi pi-exclamation-triangle",accept:()=>{this.subscriptionService.deleteSelectedSubscriptions(e._id).pipe(g(this.destroyed$)).subscribe({next:()=>{this.subscription=new U,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"Xo\xE1 \u0111\u0103ng k\xFD th\xE0nh c\xF4ng",life:3e3}),setTimeout(()=>{this.fetchSubscriptionList()},1500)},error:i=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:i.error.errMessage,life:3e3})}})}})}static{this.\u0275fac=function(i){return new(i||t)(S(v),S(C),S(pe))}}static{this.\u0275cmp=M({type:t,selectors:[["app-admin-subscription"]],standalone:!0,features:[$([C,v]),k,j],decls:11,vars:13,consts:[["dt",""],[1,"card"],["styleClass","mb-4 gap-2"],["pTemplate","left"],["dataKey","_id","currentPageReportTemplate","\u0110ang hi\u1EC7n t\u1EEB {first} t\u1EDBi {last} trong t\u1ED5ng s\u1ED1 {totalRecords} m\u1EE5c",3,"selectionChange","value","rows","paginator","tableStyle","selection","rowHover","showCurrentPageReport","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["severity","danger","label","Xo\xE1","icon","pi pi-trash","outlined","",3,"click","disabled"],[1,"d-flex","flex-column","flex-md-row","align-items-center","justify-content-between","gap-3",2,"display","flex","align-items","center"],[1,"m-0","quicksand-bold"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","T\xECm ki\u1EBFm...","aria-label","Global Search",3,"input"],[1,"quicksand-bold"],[2,"width","5rem"],["pSortableColumn","email",2,"min-width","10rem"],["field","email"],[2,"min-width","12rem"],[1,"quicksand-normal"],[2,"width","3rem"],[3,"value"],["icon","pi pi-trash","severity","danger",3,"click","outlined"],["colspan","8"]],template:function(i,o){if(i&1){let p=d();r(0,"div",1),s(1,"p-toast"),r(2,"p-toolbar",2),x(3,ge,1,1,"ng-template",3),n(),r(4,"p-table",4,0),L("selectionChange",function(y){return m(p),V(o.selectedSubscriptions,y)||(o.selectedSubscriptions=y),u(y)}),x(6,Se,8,0,"ng-template",5)(7,_e,7,0,"ng-template",6)(8,ve,7,6,"ng-template",7)(9,Ce,3,0,"ng-template",8),n(),s(10,"p-confirmDialog"),n()}i&2&&(l(4),a("value",o.subscriptionList)("rows",10)("paginator",!0)("tableStyle",f(10,de)),D("selection",o.selectedSubscriptions),a("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",f(11,he)),l(6),w(f(12,be)))},dependencies:[B,ie,Q,H,Y,Z,ee,te,ne,R,W,K,q,O,oe,re,N,G,ce,ae,le,se,J,z]})}}return t})();export{Ne as AdminSubscriptionComponent};
