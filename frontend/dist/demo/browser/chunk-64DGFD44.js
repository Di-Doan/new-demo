import{l as R}from"./chunk-QKVJLM24.js";import{a as xe,b as Ce}from"./chunk-S73STG6Q.js";import{a as ee,b as te,c as ie,d as ne,e as re,f as oe,g as le,h as se,i as ae,j as me,k as ue,l as pe,m as de,n as ce,o as _e,p as ge,q as he,r as fe}from"./chunk-GIECZPGO.js";import{e as Z,f as $}from"./chunk-BVJELWYP.js";import{g as T}from"./chunk-ZMC5WGNU.js";import{c as q,f as X,j,p as H,r as O}from"./chunk-74C73OEU.js";import{e as J,f as Y}from"./chunk-65TSPMQQ.js";import{g as G,h as K,i as z}from"./chunk-SASYOJ3X.js";import{T as U,X as A,aa as Q,m as L,n as P,q as N}from"./chunk-W4VWF4WH.js";import{Ab as C,Bb as y,Cb as m,Jb as F,Kb as s,Lb as S,Ob as h,Pb as f,Qb as x,R as b,Rb as B,Sb as W,Tb as E,Ua as l,Va as M,a as I,ga as D,j as k,jb as g,lb as u,ob as v,pa as V,qa as p,ra as d,ub as n,vb as t,wb as _}from"./chunk-5ETVNT53.js";var we=()=>({"min-width":"55rem"}),be=()=>["name","email","username","point"],ye=()=>({width:"450px"}),Se=()=>({"margin-right":"20px"}),ve=()=>({"margin-right":"10px","border-radius":"50%"}),Te=()=>({"border-radius":"50%"});function Me(r,c){if(r&1){let e=C();n(0,"div")(1,"p-button",12),y("click",function(){p(e);let i=m();return d(i.openNew())}),t(),n(2,"p-button",13),y("click",function(){p(e);let i=m();return d(i.deleteSelectedUsers())}),t()()}if(r&2){let e=m();l(),u("ngStyle",E(2,Se)),l(),u("disabled",!e.selectedUsers||!e.selectedUsers.length)}}function Ue(r,c){if(r&1){let e=C();n(0,"div",14)(1,"h5",15),s(2,"Qu\u1EA3n L\xFD Th\xF4ng Tin Ng\u01B0\u1EDDi D\xF9ng"),t(),n(3,"span",16)(4,"p-iconField")(5,"p-inputIcon"),_(6,"i",17),t(),n(7,"input",18),y("input",function(i){p(e),m();let o=F(5);return d(o.filterGlobal(i.target==null?null:i.target.value,"contains"))}),t()()()()}}function Ae(r,c){r&1&&(n(0,"tr",19)(1,"th",20),_(2,"p-tableHeaderCheckbox"),t(),n(3,"th",21),s(4," T\xEAn "),_(5,"p-sortIcon",22),t(),n(6,"th",23),s(7," T\xEAn \u0111\u0103ng nh\u1EADp "),_(8,"p-sortIcon",24),t(),n(9,"th",25),s(10," Email "),_(11,"p-sortIcon",26),t(),n(12,"th",27),s(13," \u0110i\u1EC3m "),_(14,"p-sortIcon",28),t(),n(15,"th",29),s(16," Quy\u1EC1n h\u1EA1n "),_(17,"p-sortIcon",30),t(),_(18,"th",31),t())}function Ie(r,c){if(r&1&&_(0,"p-tableCheckbox",38),r&2){let e=m().$implicit;u("value",e)}}function ke(r,c){if(r&1){let e=C();n(0,"p-button",39),y("click",function(){p(e);let i=m().$implicit,o=m();return d(o.editUser(i))}),t()}r&2&&(v(E(3,ve)),u("outlined",!0))}function De(r,c){if(r&1){let e=C();n(0,"p-button",40),y("click",function(){p(e);let i=m().$implicit,o=m();return d(o.deleteUser(i))}),t()}r&2&&(v(E(3,Te)),u("outlined",!0))}function Ve(r,c){if(r&1&&(n(0,"tr",32)(1,"td",33),g(2,Ie,1,1,"p-tableCheckbox",34),t(),n(3,"td",35),s(4),t(),n(5,"td"),s(6),t(),n(7,"td"),s(8),t(),n(9,"td"),s(10),t(),n(11,"td"),s(12),t(),n(13,"td"),g(14,ke,1,4,"p-button",36)(15,De,1,4,"p-button",37),t()()),r&2){let e=c.$implicit;l(2),u("ngIf",e.role!="superAdmin"),l(2),S(e.name),l(2),S(e.username),l(2),S(e.email),l(2),S(e.point),l(2),S(e.role),l(2),u("ngIf",e.role!="superAdmin"),l(),u("ngIf",e.role!="superAdmin")}}function Fe(r,c){r&1&&(n(0,"tr")(1,"td",41),s(2,"Kh\xF4ng c\xF3 ng\u01B0\u1EDDi d\xF9ng n\xE0o theo m\u1EE5c t\xECm ki\u1EBFm."),t()())}function Be(r,c){r&1&&(n(0,"small",59),s(1," Emai kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),t())}function We(r,c){r&1&&(n(0,"small",59),s(1," T\xEAn \u0111\u0103ng nh\u1EADp kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),t())}function Le(r,c){r&1&&(n(0,"small",59),s(1," T\xEAn kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),t())}function Pe(r,c){r&1&&(n(0,"small",59),s(1," M\u1EADt kh\u1EA9u kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng. "),t())}function Ne(r,c){r&1&&(n(0,"small",59),s(1," M\u1EADt kh\u1EA9u ph\u1EA3i n\u1EB1m trong kho\u1EA3ng t\u1EEB 6 \u0111\u1EBFn 32 k\xFD t\u1EF1. "),t())}function Re(r,c){if(r&1){let e=C();n(0,"div",42)(1,"label",60),s(2,"M\u1EADt kh\u1EA9u"),t(),n(3,"input",61),x("ngModelChange",function(i){p(e);let o=m(2);return f(o.user.password,i)||(o.user.password=i),d(i)}),t(),g(4,Pe,2,0,"small",45)(5,Ne,2,0,"small",45),t()}if(r&2){let e=m(2);l(3),h("ngModel",e.user.password),l(),u("ngIf",e.submitted&&!e.user.password),l(),u("ngIf",e.submitted&&(e.user.password.length<6||e.user.password.length>32)&&e.user.password)}}function qe(r,c){if(r&1){let e=C();n(0,"div",42)(1,"label",43),s(2,"Email"),t(),n(3,"input",44),x("ngModelChange",function(i){p(e);let o=m();return f(o.user.email,i)||(o.user.email=i),d(i)}),t(),g(4,Be,2,0,"small",45),t(),n(5,"div",42)(6,"label",46),s(7,"Username"),t(),n(8,"input",47),x("ngModelChange",function(i){p(e);let o=m();return f(o.user.username,i)||(o.user.username=i),d(i)}),t(),g(9,We,2,0,"small",45),t(),n(10,"div",42)(11,"label",48),s(12,"T\xEAn"),t(),n(13,"input",49),x("ngModelChange",function(i){p(e);let o=m();return f(o.user.name,i)||(o.user.name=i),d(i)}),t(),g(14,Le,2,0,"small",45),t(),g(15,Re,6,3,"div",50),n(16,"div",51)(17,"label",52),s(18,"\u0110i\u1EC3m"),t(),n(19,"p-inputNumber",53),x("ngModelChange",function(i){p(e);let o=m();return f(o.user.point,i)||(o.user.point=i),d(i)}),t()(),n(20,"div",51)(21,"label",52),s(22,"Quy\u1EC1n h\u1EA1n"),t(),n(23,"div",54)(24,"div",55)(25,"p-radioButton",56),x("ngModelChange",function(i){p(e);let o=m();return f(o.user.role,i)||(o.user.role=i),d(i)}),t(),n(26,"label",57),s(27," Admin "),t()(),n(28,"div",55)(29,"p-radioButton",58),x("ngModelChange",function(i){p(e);let o=m();return f(o.user.role,i)||(o.user.role=i),d(i)}),t(),n(30,"label",57),s(31," User"),t()()()()}if(r&2){let e=m();l(3),h("ngModel",e.user.email),l(),u("ngIf",e.submitted&&!e.user.email),l(4),h("ngModel",e.user.username),l(),u("ngIf",e.submitted&&!e.user.username),l(4),h("ngModel",e.user.name),l(),u("ngIf",e.submitted&&!e.user.name),l(),u("ngIf",e.user._id==null||e.user._id==null||e.user._id==""),l(4),h("ngModel",e.user.point),l(6),h("ngModel",e.user.role),l(4),h("ngModel",e.user.role)}}function Xe(r,c){if(r&1){let e=C();n(0,"p-button",62),y("click",function(){p(e);let i=m();return d(i.hideDialog())}),t(),n(1,"p-button",63),y("click",function(){p(e);let i=m();return d(i.saveUser())}),t()}r&2&&(u("text",!0),l(),u("text",!0))}var wt=(()=>{class r{constructor(e,a,i){this.authService=e,this.confirmationService=a,this.messageService=i,this.userDialog=!1,this.submitted=!1,this.destroyed$=new k}ngOnInit(){this.fetchUserList()}ngOnChanges(e){this.fetchUserList()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}fetchUserList(){this.authService.fetchAllUser().pipe(b(this.destroyed$)).subscribe({next:e=>{this.userList=e.data},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}})}openNew(){this.user=new T,this.submitted=!1,this.userDialog=!0}deleteSelectedUsers(){this.confirmationService.confirm({message:"X\xE1c nh\u1EADn xo\xE1 ng\u01B0\u1EDDi d\xF9ng \u0111\xE3 ch\u1ECDn?",header:"X\xE1c nh\u1EADn",icon:"pi pi-exclamation-triangle",accept:()=>{this.authService.deleteMultipleUsers(this.selectedUsers).pipe(b(this.destroyed$)).subscribe({next:()=>{this.selectedUsers=null,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"Xo\xE1 ng\u01B0\u1EDDi d\xF9ng th\xE0nh c\xF4ng",life:3e3}),setTimeout(()=>{this.fetchUserList()},1500)},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}})}})}editUser(e){this.user=I({},e),this.userDialog=!0}deleteUser(e){this.confirmationService.confirm({message:"X\xE1c nh\u1EADn xo\xE1 "+e.name+"?",header:"X\xE1c nh\u1EADn",icon:"pi pi-exclamation-triangle",accept:()=>{this.authService.deleteSelectedUser(e._id).pipe(b(this.destroyed$)).subscribe({next:()=>{this.user=new T,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"Xo\xE1 ng\u01B0\u1EDDi d\xF9ng th\xE0nh c\xF4ng",life:3e3}),setTimeout(()=>{this.fetchUserList()},1500)},error:a=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:a.error.errMessage,life:3e3})}})}})}hideDialog(){this.userDialog=!1,this.submitted=!1}saveUser(){if(this.submitted=!0,!Object.entries(this.user).some(([e,a])=>e!=="_id"&&a===""))if(this.user._id)this.authService.updateUserInfo(this.user._id,this.user).pipe(b(this.destroyed$)).subscribe({next:()=>{this.hideDialog(),this.user=new T,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"C\u1EADp nh\u1EADt ng\u01B0\u1EDDi d\xF9ng th\xE0nh c\xF4ng",life:3e3}),setTimeout(()=>{this.fetchUserList()},1500)},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}});else{if(this.user.password.length<6||this.user.password.length>32)return;this.authService.createNewUser(this.user).pipe(b(this.destroyed$)).subscribe({next:()=>{this.hideDialog(),this.user=new T,this.messageService.add({severity:"success",summary:"Th\xE0nh c\xF4ng",detail:"T\u1EA1o ng\u01B0\u1EDDi d\xF9ng th\xE0nh c\xF4ng",life:3e3}),setTimeout(()=>{this.fetchUserList()},1500)},error:e=>{this.messageService.add({severity:"error",summary:"L\u1ED7i",detail:e.error.errMessage,life:3e3})}})}}static{this.\u0275fac=function(a){return new(a||r)(M(R),M(U),M(A))}}static{this.\u0275cmp=D({type:r,selectors:[["app-admin-user"]],standalone:!0,features:[B([A,U]),V,W],decls:14,vars:19,consts:[["dt",""],[1,"card"],["styleClass","mb-4 toolbar"],["pTemplate","left"],["dataKey","_id","currentPageReportTemplate","\u0110ang hi\u1EC7n t\u1EEB {first} t\u1EDBi {last} trong t\u1ED5ng s\u1ED1 {totalRecords} m\u1EE5c",3,"selectionChange","value","rows","paginator","tableStyle","selection","rowHover","showCurrentPageReport","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng","styleClass","p-fluid quicksand-bold",3,"visibleChange","visible","modal","dismissableMask"],["pTemplate","content"],["pTemplate","footer"],["label","T\u1EA1o m\u1EDBi","icon","pi pi-plus",3,"click","ngStyle"],["severity","danger","label","Xo\xE1 ","icon","pi pi-trash","outlined","",3,"click","disabled"],[1,"d-flex","flex-column","flex-md-row","align-items-center","justify-content-between","gap-3",2,"display","flex","align-items","center"],[1,"m-0","mr-3","quicksand-bold"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","T\xECm ki\u1EBFm...","aria-label","Global Search",3,"input"],[1,"quicksand-bold"],[2,"width","5rem"],["pSortableColumn","name",2,"min-width","5rem"],["field","name"],["pSortableColumn","username",2,"min-width","10rem"],["field","username"],["pSortableColumn","email",2,"min-width","10rem"],["field","email"],["pSortableColumn","point",2,"min-width","10rem"],["field","point"],["pSortableColumn","role",2,"min-width","10rem"],["field","role"],[2,"min-width","12rem"],[1,"quicksand-normal"],[2,"width","3rem"],[3,"value",4,"ngIf"],[2,"min-width","10rem"],["icon","pi pi-pencil","class","mr-2","severity","success",3,"outlined","style","click",4,"ngIf"],["icon","pi pi-trash","severity","danger",3,"outlined","style","click",4,"ngIf"],[3,"value"],["icon","pi pi-pencil","severity","success",1,"mr-2",3,"click","outlined"],["icon","pi pi-trash","severity","danger",3,"click","outlined"],["colspan","8"],[1,"field"],["for","email",1,"my-2"],["type","email","pInputText","","id","email","required","",3,"ngModelChange","ngModel"],["class","p-error",4,"ngIf"],["for","username",1,"my-2"],["type","text","pInputText","","id","username","required","",3,"ngModelChange","ngModel"],["for","name",1,"my-2"],["type","text","pInputText","","id","name","required","","autofocus","",3,"ngModelChange","ngModel"],["class","field",4,"ngIf"],[1,"field","col"],["for","point",1,"my-2"],["id","point",3,"ngModelChange","ngModel"],[1,"flex","gap-3",2,"flex-wrap","nowrap","display","flex"],[1,"flex","align-items-center",2,"flex-shrink","0"],["name","role","value","admin","inputId","adminRole",3,"ngModelChange","ngModel"],["for","adminRole",1,"ml-2",2,"margin-left","5px"],["name","role","value","user","inputId","userRole",3,"ngModelChange","ngModel"],[1,"p-error"],["for","password",1,"my-2"],["type","password","pInputText","","id","password","required","",3,"ngModelChange","ngModel"],["label","H\u1EE7y","icon","pi pi-times",3,"click","text"],["label","L\u01B0u","icon","pi pi-check",3,"click","text"]],template:function(a,i){if(a&1){let o=C();n(0,"div",1),_(1,"p-toast"),n(2,"p-toolbar",2),g(3,Me,3,3,"ng-template",3),t(),n(4,"p-table",4,0),x("selectionChange",function(w){return p(o),f(i.selectedUsers,w)||(i.selectedUsers=w),d(w)}),g(6,Ue,8,0,"ng-template",5)(7,Ae,19,0,"ng-template",6)(8,Ve,16,8,"ng-template",7)(9,Fe,3,0,"ng-template",8),t(),n(10,"p-dialog",9),x("visibleChange",function(w){return p(o),f(i.userDialog,w)||(i.userDialog=w),d(w)}),g(11,qe,32,10,"ng-template",10)(12,Xe,2,2,"ng-template",11),t(),_(13,"p-confirmDialog"),t()}a&2&&(l(4),u("value",i.userList)("rows",10)("paginator",!0)("tableStyle",E(15,we)),h("selection",i.selectedUsers),u("rowHover",!0)("showCurrentPageReport",!0)("globalFilterFields",E(16,be)),l(6),v(E(17,ye)),h("visible",i.userDialog),u("modal",!0)("dismissableMask",!0),l(3),v(E(18,ye)))},dependencies:[N,L,P,O,q,X,H,j,me,re,Q,oe,le,se,ae,pe,ue,G,Y,J,z,K,ce,de,$,Z,fe,he,ge,_e,ne,ie,Ce,xe,te,ee]})}}return r})();export{wt as AdminUserComponent};
